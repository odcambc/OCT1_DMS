"0",""
"0","order <- c('D_3','D_2','D_1','I_3','I_2','I_1','H', 'K', 'R', 'D', 'E',"
"0","          'C','M','N','Q','S','T','A','I','L','V','W','F',"
"0","          'Y','G','P')"
"0",""
"0","variant_names <- c(""Del x3"",'Del x2','Del x1','Ins x3 (GSG)','Ins x (GS)','Ins x1 (G)','H', 'K', 'R', 'D', 'E',"
"0","          'C','M','N','Q','S','T','A','I','L','V','W','F',"
"0","          'Y','G','P')"
"0",""
"0","kir_wt_1 = str_split(substr(kir21_wt, 1, 150), '')[[1]]"
"0","kir_wt_2 = str_split(substr(kir21_wt, 151, 300), '')[[1]]"
"0","kir_wt_3 = str_split(substr(kir21_wt, 301, 440), '')[[1]]"
"0",""
"0","#surface plot"
"0","Surface_row1 = ggplot(data = kir_scores[kir_scores$pos %in% c(2:150),], "
"0","                      aes(x = pos, y = factor(variants, level = order, labels = variant_names), fill = S_SE )) +"
"0","  geom_tile(aes(color = as.factor(is.wt)), size = 0.2) +"
"0","  scale_fill_continuous_divergingx(palette = 'RdBu', mid = 0,l1=0.2, l3 = 0.2, p1=0.9, p3 = .4, p4 = 0.9,rev=FALSE, na.value = 'lightyellow',limits=c(-5,3)) + "
"0","  scale_color_manual(values = c(NA,'green')) +"
"0","  scale_x_continuous(breaks = seq(0, 400, by = 5),"
"0","                     expand = c(0,0),"
"0","                     sec.axis = sec_axis("
"0","                      trans = ~.,"
"0","                      name = ""Sequence"","
"0","                      breaks = seq(1, 150),"
"0","                      labels = kir_wt_1,"
"0","                      guide = derive()"
"0","                    )) +"
"0","  coord_fixed(ratio = 1) +"
"0","  theme("
"0","    panel.background = element_rect(fill = ""white"","
"0","                                    colour = ""white"","
"0","                                    size = 0.5, linetype = ""solid""),"
"0","    panel.grid.major = element_line(size = 0.5, linetype = 'solid',"
"0","                                    colour = ""lightgray""), "
"0","    panel.grid.minor = element_blank(),"
"0","    axis.text.x = element_text(angle = 90, hjust = 1, size = 6),"
"0","    axis.text.y = element_text(size = 4),"
"0","    axis.text = element_text(size = 4),"
"0","    axis.text.x.top = element_text(angle = 0, hjust = 0.5, family = ""mono""),"
"0","    axis.ticks = element_blank(),"
"0","    legend.position=""none"""
"0","  ) +"
"0","  labs(y = ""Mutation"", x = ""Position"")"
"0",""
"0","Surface_row2 = ggplot(data = kir_scores[kir_scores$pos %in% c(151:300),], "
"0","                      aes(x = pos, y = factor(variants, level = order), fill = S_SE)) +"
"0","  geom_tile(aes(color = as.factor(is.wt)), size = 0.2) +"
"0","  scale_fill_continuous_divergingx(palette = 'RdBu', mid = 0,l1=0.2, l3 = 0.2, p1=0.9, p3 = .4, p4 = 0.9,rev=FALSE, na.value = 'lightyellow',limits=c(-5,3)) + "
"0","  scale_color_manual(values = c(NA,'green')) +"
"0","  scale_x_continuous(breaks = seq(0, 400, by = 5),"
"0","                     expand = c(0,0),"
"0","                     sec.axis = sec_axis("
"0","                      trans = ~.,"
"0","                      name = ""Sequence"","
"0","                      breaks = seq(151, 300),"
"0","                      labels = kir_wt_2,"
"0","                      guide = derive()"
"0","                    )) +"
"0","  coord_fixed(ratio = 1) +"
"0","  theme("
"0","    panel.background = element_rect(fill = ""white"","
"0","                                    colour = ""white"","
"0","                                    size = 0.5, linetype = ""solid""),"
"0","    panel.grid.major = element_line(size = 0.5, linetype = 'solid',"
"0","                                    colour = ""lightgray""), "
"0","    panel.grid.minor = element_blank(),"
"0","    axis.text.x = element_text(angle = 90, hjust = 1, size = 6),"
"0","    axis.text.y = element_text(size = 4),"
"0","    axis.text = element_text(size = 4),"
"0","    axis.text.x.top = element_text(angle = 0, hjust = 0.5, family = ""mono""),"
"0","    axis.ticks = element_blank(),"
"0","    legend.position=""none"""
"0","  ) +"
"0","  labs(y = ""Mutation"", x = ""Position"")"
"0",""
"0","Surface_row3 = ggplot(data = kir_scores[kir_scores$pos %in% c(301:440),], "
"0","                      aes(x = pos, y = factor(variants, level = order), fill = S_SE)) +"
"0","  geom_tile(aes(color = as.factor(is.wt)), size = 0.2) +"
"0","  scale_fill_continuous_divergingx(palette = 'RdBu', mid = 0,l1=0.2, l3 = 0.2, p1=0.9, p3 = .4, p4 = 0.9,rev=FALSE, na.value = 'lightyellow',limits=c(-5,3)) + "
"0","  scale_color_manual(values = c(NA,'green')) +"
"0","  scale_x_continuous(breaks = seq(0, 440, by = 5),"
"0","                     expand = c(0,0),"
"0","                     sec.axis = sec_axis("
"0","                      trans = ~.,"
"0","                      name = ""Sequence"","
"0","                      breaks = seq(301, 440),"
"0","                      labels = kir_wt_3,"
"0","                      guide = derive()"
"0","                    )) +"
"0","  coord_fixed(ratio = 1) +"
"0","  theme("
"0","    panel.background = element_rect(fill = ""white"","
"0","                                    colour = ""white"","
"0","                                    size = 0.5, linetype = ""solid""),"
"0","    panel.grid.major = element_line(size = 0.5, linetype = 'solid',"
"0","                                    colour = ""lightgray""), "
"0","    panel.grid.minor = element_blank(),"
"0","    axis.text.x = element_text(angle = 90, hjust = 1, size = 6),"
"0","    axis.text.y = element_text(size = 4),"
"0","    axis.text = element_text(size = 4),"
"0","    axis.text.x.top = element_text(angle = 0, hjust = 0.5, family = ""mono""),"
"0","    axis.ticks = element_blank(),"
"0","    legend.position=""none"""
"0","  ) +"
"0","  labs(y = ""Mutation"", x = ""Position"")"
"0",""
"0",""
"0","Surface_DMS_SE = ggarrange(Surface_row1, Surface_row2, Surface_row3,"
"0","                        nrow = 3, ncol = 1)"
"0",""
"0","ggsave(""~/Desktop/dms_analysis/Plotting/Plots/Figures/SI_heatmap_SE.pdf"", height = 7, width = 8.5)"
"0","ggsave(""~/Desktop/dms_analysis/Plotting/Plots/Figures/SI_heatmap_SE.png"", height = 7, width = 8.5)"
"0",""
