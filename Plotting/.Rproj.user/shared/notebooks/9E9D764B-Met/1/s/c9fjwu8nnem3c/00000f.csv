"0","order <- c('X','H', 'K', 'R', 'D', 'E',"
"0","          'C','M','N','Q','S','T','A','I','L','V','W','F',"
"0","          'Y','G','P')"
"0",""
"0","variant_names <- c('Stop','H', 'K', 'R', 'D', 'E',"
"0","          'C','M','N','Q','S','T','A','I','L','V','W','F',"
"0","          'Y','G','P')"
"0",""
"0","met_wt_1 = str_split(substr(met_wt_sequence, 1, 100), '')[[1]]"
"0","met_wt_2 = str_split(substr(met_wt_sequence, 101, 200), '')[[1]]"
"0","met_wt_3 = str_split(substr(met_wt_sequence, 201, 287), '')[[1]]"
"0",""
"0","Met_row1 = ggplot(data = met_scores %>% mutate(pos = pos - 1058) %>% filter(pos %in% c(1:100)), "
"0","                      aes(x = pos, y = factor(variants, level = order, labels = variant_names), fill = IL3_withdrawal_score )) +"
"0","  geom_tile(aes(color = as.factor(is.wt)), size = 0.2) +"
"0","  scale_fill_continuous_divergingx(palette = 'RdBu', mid = 0,l1=0.2, l3 = 0.2, p1=0.9, p3 = .4, p4 = 0.9,rev=FALSE, na.value = 'lightyellow',limits=c(-15,6)) + "
"0","  scale_color_manual(values = c(NA,'green')) +"
"0","  scale_x_continuous(breaks = seq(0, 100, by = 5),"
"0","                     expand = c(0,0),"
"0","                     sec.axis = sec_axis("
"0","                      trans = ~.,"
"0","                      name = ""Sequence"","
"0","                      breaks = seq(1, 100),"
"0","                      labels = met_wt_1,"
"0","                      guide = derive()"
"0","                    )) +"
"0","  coord_fixed(ratio = 1) +"
"0","  theme("
"0","    panel.background = element_rect(fill = ""white"","
"0","                                    colour = ""white"","
"0","                                    size = 0.5, linetype = ""solid""),"
"0","    panel.grid.major = element_line(size = 0.5, linetype = 'solid',"
"0","                                    colour = ""lightgray""), "
"0","    panel.grid.minor = element_blank(),"
"0","    axis.text.x = element_text(angle = 90, hjust = 1, size = 6),"
"0","    axis.text.y = element_text(size = 4),"
"0","    axis.text = element_text(size = 4),"
"0","    axis.text.x.top = element_text(angle = 0, hjust = 0.5, family = ""mono""),"
"0","    axis.ticks = element_blank(),"
"0","    legend.position=""none"""
"0","  ) +"
"0","  labs(y = ""Mutation"", x = ""Position"")"
"0",""
"0","Met_row2 = ggplot(data = met_scores %>% mutate(pos = pos - 1058) %>% filter(pos %in% c(101:200)), "
"0","                      aes(x = pos, y = factor(variants, level = order, labels = variant_names), fill = IL3_withdrawal_score )) +"
"0","  geom_tile(aes(color = as.factor(is.wt)), size = 0.2) +"
"0","  scale_fill_continuous_divergingx(palette = 'RdBu', mid = 0,l1=0.2, l3 = 0.2, p1=0.9, p3 = .4, p4 = 0.9,rev=FALSE, na.value = 'lightyellow',limits=c(-15,6)) + "
"0","  scale_color_manual(values = c(NA,'green')) +"
"0","  scale_x_continuous(breaks = seq(101, 200, by = 5),"
"0","                     expand = c(0,0),"
"0","                     sec.axis = sec_axis("
"0","                      trans = ~.,"
"0","                      name = ""Sequence"","
"0","                      breaks = seq(101, 200),"
"0","                      labels = met_wt_2,"
"0","                      guide = derive()"
"0","                    )) +"
"0","  coord_fixed(ratio = 1) +"
"0","  theme("
"0","    panel.background = element_rect(fill = ""white"","
"0","                                    colour = ""white"","
"0","                                    size = 0.5, linetype = ""solid""),"
"0","    panel.grid.major = element_line(size = 0.5, linetype = 'solid',"
"0","                                    colour = ""lightgray""), "
"0","    panel.grid.minor = element_blank(),"
"0","    axis.text.x = element_text(angle = 90, hjust = 1, size = 6),"
"0","    axis.text.y = element_text(size = 4),"
"0","    axis.text = element_text(size = 4),"
"0","    axis.text.x.top = element_text(angle = 0, hjust = 0.5, family = ""mono""),"
"0","    axis.ticks = element_blank(),"
"0","    legend.position=""none"""
"0","  ) +"
"0","  labs(y = ""Mutation"", x = ""Position"")"
"0",""
"0","Met_row3 = ggplot(data = met_scores %>% mutate(pos = pos - 1058) %>% filter(pos %in% c(201:287)), "
"0","                      aes(x = pos, y = factor(variants, level = order, labels = variant_names), fill = IL3_withdrawal_score )) +"
"0","  geom_tile(aes(color = as.factor(is.wt)), size = 0.2) +"
"0","  scale_fill_continuous_divergingx(palette = 'RdBu', mid = 0,l1=0.2, l3 = 0.2, p1=0.9, p3 = .4, p4 = 0.9,rev=FALSE, na.value = 'lightyellow',limits=c(-15,6)) + "
"0","  scale_color_manual(values = c(NA,'green')) +"
"0","  scale_x_continuous(breaks = seq(201, 287, by = 5),"
"0","                     expand = c(0,0),"
"0","                     sec.axis = sec_axis("
"0","                      trans = ~.,"
"0","                      name = ""Sequence"","
"0","                      breaks = seq(201, 287),"
"0","                      labels = met_wt_3,"
"0","                      guide = derive()"
"0","                    )) +"
"0","  coord_fixed(ratio = 1) +"
"0","  theme("
"0","    panel.background = element_rect(fill = ""white"","
"0","                                    colour = ""white"","
"0","                                    size = 0.5, linetype = ""solid""),"
"0","    panel.grid.major = element_line(size = 0.5, linetype = 'solid',"
"0","                                    colour = ""lightgray""), "
"0","    panel.grid.minor = element_blank(),"
"0","    axis.text.x = element_text(angle = 90, hjust = 1, size = 6),"
"0","    axis.text.y = element_text(size = 4),"
"0","    axis.text = element_text(size = 4),"
"0","    axis.text.x.top = element_text(angle = 0, hjust = 0.5, family = ""mono""),"
"0","    axis.ticks = element_blank(),"
"0","    legend.position=""right"""
"0","  ) +"
"0","  labs(y = ""Mutation"", x = ""Position"")"
"0",""
"0","Met_DMS = ggarrange(Met_row1, Met_row2, Met_row3,"
"0","                        nrow = 3, ncol = 1)"
"0",""
"0","ggsave(""Plots/Met_IL3_withdrawal_heatmap.pdf"", height = 7, width = 8.5, Met_DMS)"
"0","ggsave(""Plots/Met_IL3_withdrawal_heatmap.png"", height = 7, width = 8.5, Met_DMS)"
"0",""
