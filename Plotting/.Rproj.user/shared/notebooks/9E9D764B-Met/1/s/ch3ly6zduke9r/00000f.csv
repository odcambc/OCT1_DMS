"0",""
"0","# Met Enrich2 score files"
"0","met_scores_file = ""../data/Enrich2/Met/tsv/TPR_MET_enrich2_config_exp/main_identifiers_scores.tsv"""
"0",""
"0","ex_scores_file = ""../data/Enrich2/Met_Ex/tsv/TPR_MET_enrich2_ex_config_exp/main_identifiers_scores.tsv"""
"0",""
"0","met_variantscore_colnames <- c(""hgvs"", ""IL3_SE"", ""IL3_epsilon"", ""IL3_score"","
"0","                               ""IL3_withdrawal_SE"", ""IL3_withdrawal_epsilon"", ""IL3_withdrawal_score"")"
"0",""
"0","met_variantscore_coltypes <- c(""character"", ""numeric"", ""numeric"", ""numeric"", ""numeric"", ""numeric"", ""numeric"")"
"0",""
"0","met_scores <- read_delim(met_scores_file, col_names = met_variantscore_colnames, skip=3)"
"2","[1mRows: [22m[34m5704[39m [1mColumns: [22m[34m7[39m"
"2","[36mâ”€â”€[39m [1mColumn specification[22m [36mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[1mDelimiter:[22m ""\t""
[31mchr[39m (1): hgvs
[32mdbl[39m (6): IL3_SE, IL3_epsilon, IL3_score, IL3_withdrawal_SE, IL3_withdrawal_epsilon, IL3_withdrawal_score"
"2","
[36mâ„¹[39m Use `spec()` to retrieve the full column specification for this data.
[36mâ„¹[39m Specify the column types or set `show_col_types = FALSE` to quiet this message."
"0","met_scores <- process_hgvs_df(met_scores)"
"0","met_scores$is.wt = met_scores$mutation_type == ""S"""
"0",""
"0","ex_scores <- read_delim(ex_scores_file, col_names = met_variantscore_colnames, skip=3)"
"2","[1mRows: [22m[34m5745[39m [1mColumns: [22m[34m7[39m"
"2","[36mâ”€â”€[39m [1mColumn specification[22m [36mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[1mDelimiter:[22m ""\t""
[31mchr[39m (1): hgvs
[32mdbl[39m (6): IL3_SE, IL3_epsilon, IL3_score, IL3_withdrawal_SE, IL3_withdrawal_epsilon, IL3_withdrawal_score"
"2","
[36mâ„¹[39m Use `spec()` to retrieve the full column specification for this data.
[36mâ„¹[39m Specify the column types or set `show_col_types = FALSE` to quiet this message."
"0","ex_scores <- process_hgvs_df(ex_scores)"
"0","ex_scores$is.wt = ex_scores$mutation_type == ""S"""
"0",""
"0","met_wt_fasta = ""Met_wt.fasta"""
"0",""
"0","met_wt_fasta_con=file(met_wt_fasta, open=""r"")"
"0","met_wt_sequence = readLines(met_wt_fasta_con)[2]"
"2","Warning: incomplete final line found on 'Met_wt.fasta'"
"0","close(met_wt_fasta_con)"
"0",""
"0","# Adjust position to correspond with actual numbering"
"0","met_scores <- met_scores %>% mutate(pos = pos+1058)"
"0",""
"0","met_avg_scores <- met_scores %>% group_by(pos) %>% summarise(avg_IL3 = mean(IL3_score, na.rm=TRUE),"
"0","                                            avg_IL3_withdrawal = mean(IL3_withdrawal_score, na.rm=TRUE))"
"0",""
"0","met_var_scores <- met_scores %>% group_by(pos) %>% summarise(var_IL3 = var(IL3_score, na.rm=TRUE),"
"0","                                          var_IL3_withdrawal = var(IL3_withdrawal_score, na.rm=TRUE))"
"0",""
"0","met_max_scores <- met_scores %>% group_by(pos) %>% summarise(max_IL3 = max(IL3_score, na.rm=TRUE),"
"0","                                            max_IL3_withdrawal = max(IL3_withdrawal_score, na.rm=TRUE))"
"0",""
"0","ex_scores <- ex_scores %>% mutate(pos = pos+1058)"
"0",""
"0","ex_avg_scores <- ex_scores %>% group_by(pos) %>% summarise(avg_IL3 = mean(IL3_score, na.rm=TRUE),"
"0","                                            avg_IL3_withdrawal = mean(IL3_withdrawal_score, na.rm=TRUE))"
"0",""
"0","ex_var_scores <- ex_scores %>% group_by(pos) %>% summarise(var_IL3 = var(IL3_score, na.rm=TRUE),"
"0","                                          var_IL3_withdrawal = var(IL3_withdrawal_score, na.rm=TRUE))"
"0",""
"0","ex_max_scores <- ex_scores %>% group_by(pos) %>% summarise(max_IL3 = max(IL3_score, na.rm=TRUE),"
"0","                                            max_IL3_withdrawal = max(IL3_withdrawal_score, na.rm=TRUE))"
"0",""
"0","combined_scores <- full_join(met_scores, ex_scores, by = c('hgvs' = 'hgvs'), keep = TRUE, suffix = c(""_Met"", ""_Ex""))"
"0",""
