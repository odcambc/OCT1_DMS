"0",""
"0","order <- c('D_3','D_2','D_1','I_3','I_2','I_1','H', 'K', 'R', 'D', 'E',"
"0","          'C','M','N','Q','S','T','A','I','L','V','W','F',"
"0","          'Y','G','P')"
"0",""
"0","variant_names <- c(""Del x3"",'Del x2','Del x1','Ins x3 (GSG)','Ins x (GS)','Ins x1 (G)','H', 'K', 'R', 'D', 'E',"
"0","          'C','M','N','Q','S','T','A','I','L','V','W','F',"
"0","          'Y','G','P')"
"0",""
"0","vatd_wt_1 = str_split(substr(vatd_wt, 1, 110), '')[[1]]"
"0","vatd_wt_2 = str_split(substr(vatd_wt, 111, 209), '')[[1]]"
"0",""
"0","vatd_ss_1 = str_split(substr(vatd_1khr_ss, 1, 110), '')[[1]]"
"0","vatd_ss_2 = str_split(substr(vatd_1khr_ss, 111, 209), '')[[1]]"
"0",""
"0","vm2_25_row1 = ggplot(data = vatd_scores[vatd_scores$pos %in% c(1:110),], "
"0","                      aes(x = pos, y = factor(variants, level = order, labels = variant_names), fill = score_25 )) +"
"0","  geom_tile(aes(color = as.factor(is.wt)), size = 0.2) +"
"0","  scale_fill_continuous_divergingx(palette = 'RdBu', mid = 0,l1=0.2, l3 = 0.2, p1=0.9, p3 = .4, p4 = 0.9,rev=FALSE, na.value = 'lightyellow',limits=c(-5,2)) + "
"0","  scale_color_manual(values = c(NA,'green')) +"
"0","  scale_x_continuous(breaks = seq(0, 400, by = 5),"
"0","                     expand = c(0,0),"
"0","                     sec.axis = sec_axis("
"0","                      trans = ~.,"
"0","                      name = ""Sequence"","
"0","                      breaks = seq(1, 110),"
"0","                      labels = vatd_wt_1,"
"0","                      guide = derive()"
"0","                    )) +"
"0","  coord_fixed(ratio = 1) +"
"0","  theme("
"0","    panel.background = element_rect(fill = ""white"","
"0","                                    colour = ""white"","
"0","                                    size = 0.5, linetype = ""solid""),"
"0","    panel.grid.major = element_line(size = 0.5, linetype = 'solid',"
"0","                                    colour = ""lightgray""), "
"0","    panel.grid.minor = element_blank(),"
"0","    axis.text.x = element_text(angle = 90, hjust = 1, size = 6),"
"0","    axis.text.y = element_text(size = 4),"
"0","    axis.text = element_text(size = 4),"
"0","    axis.text.x.top = element_text(angle = 0, hjust = 0.5, family = ""mono""),"
"0","    axis.ticks = element_blank(),"
"0","    legend.position=""none"""
"0","  ) +"
"0","  labs(y = ""Mutation"", x = ""Position"")"
"0",""
"0","vm2_25_row2 = ggplot(data = vatd_scores[vatd_scores$pos %in% c(111:209),], "
"0","                      aes(x = pos, y = factor(variants, level = order, labels = variant_names), fill = score_25 )) +"
"0","  geom_tile(aes(color = as.factor(is.wt)), size = 0.2) +"
"0","  scale_fill_continuous_divergingx(palette = 'RdBu', mid = 0,l1=0.2, l3 = 0.2, p1=0.9, p3 = .4, p4 = 0.9,rev=FALSE, na.value = 'lightyellow',limits=c(-5,2)) + "
"0","  scale_color_manual(values = c(NA,'green')) +"
"0","  scale_x_continuous(breaks = seq(0, 400, by = 5),"
"0","                     expand = c(0,0),"
"0","                     sec.axis = sec_axis("
"0","                      trans = ~.,"
"0","                      name = ""Sequence"","
"0","                      breaks = seq(111, 209),"
"0","                      labels = vatd_wt_2,"
"0","                      guide = derive()"
"0","                    )) +"
"0","  coord_fixed(ratio = 1) +"
"0","  theme("
"0","    panel.background = element_rect(fill = ""white"","
"0","                                    colour = ""white"","
"0","                                    size = 0.5, linetype = ""solid""),"
"0","    panel.grid.major = element_line(size = 0.5, linetype = 'solid',"
"0","                                    colour = ""lightgray""), "
"0","    panel.grid.minor = element_blank(),"
"0","    axis.text.x = element_text(angle = 90, hjust = 1, size = 6),"
"0","    axis.text.y = element_text(size = 4),"
"0","    axis.text = element_text(size = 4),"
"0","    axis.text.x.top = element_text(angle = 0, hjust = 0.5, family = ""mono""),"
"0","    axis.ticks = element_blank(),"
"0","    legend.position=""none"""
"0","  ) +"
"0","  labs(y = ""Mutation"", x = ""Position"")"
"0",""
"0","vatd_25_vm2 = ggarrange(vm2_25_row1, vm2_25_row2,"
"0","                        nrow = 2, ncol = 1)"
"0",""
"0","ggsave(""~/Desktop/dms_analysis/Plotting/Plots/VM2_25.pdf"", height = 7, width = 8.5)"
"0","ggsave(""~/Desktop/dms_analysis/Plotting/Plots/VM2_25.png"", height = 7, width = 8.5)"
"0",""
